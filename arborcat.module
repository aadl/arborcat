<?php
/**
 * Display help and module information
 * @return help text for section
 */
function arborcat_help($path, $arg) {
  $output = '';

  switch ($path) {
    case "admin/help#arborcat":
      $output = '<p>' .  t("Catalog functions for Evergreen") . '</p>';
      break;
  }

  return $output;
}

function arborcat_theme($existing, $type, $theme, $path) {
  return [
    'catalog' => [
      'variables' => [
        'catalog_slider' => NULL,
        'community_slider' => NULL,
        'podcast_slider' => NULL
      ]
    ],
    'catalog_record' => [
      'variables' => [
        'record' => NULL,
        'api_key' => NULL,
        'lists' => NULL,
        'reviews' => NULL,
        'review_form' => NULL
      ]
    ],
  ];
}

function arborcat_generate_api_key() {
  // Use the UUID service to generate a Unique identifier
  $uuid_service = \Drupal::service('uuid');
  return $uuid_service->generate();
}

// set drupal messages for fees or expired card
function arborcat_patron_fines_expired($fines, $patron) {
  $patron_clean = TRUE;

  if ($fines->total > 25) {
    drupal_set_message("We're sorry, but your account balance is over $25. You won't be able to renew or request items.", 'error');
    $patron_clean = FALSE;
  }
  if (strtotime($patron->expires) < time()) {
    drupal_set_message("We're sorry, but your card has expired! You can renew in person at any AADL Location.", 'error');
    $patron_clean = FALSE;
  }

  return $patron_clean;
}
